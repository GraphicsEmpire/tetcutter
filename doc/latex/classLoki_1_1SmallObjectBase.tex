\hypertarget{classLoki_1_1SmallObjectBase}{}\section{Loki\+:\+:Small\+Object\+Base$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$ Class Template Reference}
\label{classLoki_1_1SmallObjectBase}\index{Loki\+::\+Small\+Object\+Base$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$@{Loki\+::\+Small\+Object\+Base$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$}}


{\ttfamily \#include $<$Small\+Obj.\+h$>$}

Inheritance diagram for Loki\+:\+:Small\+Object\+Base$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=0.335664cm]{classLoki_1_1SmallObjectBase}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef \hyperlink{classLoki_1_1AllocatorSingleton}{Allocator\+Singleton}$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy $>$ \hyperlink{classLoki_1_1SmallObjectBase_ad07df1c9ec9c41580e07e32eddcda82d}{Obj\+Allocator\+Singleton}
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classLoki_1_1SmallObjectBase_a39f9c8d5b17c09bece34c8a400981970}{}static void $\ast$ \hyperlink{classLoki_1_1SmallObjectBase_a39f9c8d5b17c09bece34c8a400981970}{operator new} (std\+::size\+\_\+t size)  throw ( std\+::bad\+\_\+alloc )\label{classLoki_1_1SmallObjectBase_a39f9c8d5b17c09bece34c8a400981970}

\begin{DoxyCompactList}\small\item\em Throwing single-\/object new throws bad\+\_\+alloc when allocation fails. \end{DoxyCompactList}\item 
\hypertarget{classLoki_1_1SmallObjectBase_ad212efa68b48292bf8fd2dd158b49400}{}static void $\ast$ \hyperlink{classLoki_1_1SmallObjectBase_ad212efa68b48292bf8fd2dd158b49400}{operator new} (std\+::size\+\_\+t size, const std\+::nothrow\+\_\+t \&)  throw ()\label{classLoki_1_1SmallObjectBase_ad212efa68b48292bf8fd2dd158b49400}

\begin{DoxyCompactList}\small\item\em Non-\/throwing single-\/object new returns N\+U\+L\+L if allocation fails. \end{DoxyCompactList}\item 
\hypertarget{classLoki_1_1SmallObjectBase_adbbe1bde0960a38502af0940004d942f}{}static void $\ast$ \hyperlink{classLoki_1_1SmallObjectBase_adbbe1bde0960a38502af0940004d942f}{operator new} (std\+::size\+\_\+t size, void $\ast$place)\label{classLoki_1_1SmallObjectBase_adbbe1bde0960a38502af0940004d942f}

\begin{DoxyCompactList}\small\item\em Placement single-\/object new merely calls global placement new. \end{DoxyCompactList}\item 
\hypertarget{classLoki_1_1SmallObjectBase_a698e8b9ebac9df8c03e557c842a59bc5}{}static void \hyperlink{classLoki_1_1SmallObjectBase_a698e8b9ebac9df8c03e557c842a59bc5}{operator delete} (void $\ast$p, std\+::size\+\_\+t size)  throw ()\label{classLoki_1_1SmallObjectBase_a698e8b9ebac9df8c03e557c842a59bc5}

\begin{DoxyCompactList}\small\item\em Single-\/object delete. \end{DoxyCompactList}\item 
static void \hyperlink{classLoki_1_1SmallObjectBase_ab835d84fa8bc1ed3a558dc2e7a7e39ec}{operator delete} (void $\ast$p, const std\+::nothrow\+\_\+t \&)  throw ()
\item 
\hypertarget{classLoki_1_1SmallObjectBase_ae2da17da13c6c6a0d7e33c9df9eb27f2}{}static void \hyperlink{classLoki_1_1SmallObjectBase_ae2da17da13c6c6a0d7e33c9df9eb27f2}{operator delete} (void $\ast$p, void $\ast$place)\label{classLoki_1_1SmallObjectBase_ae2da17da13c6c6a0d7e33c9df9eb27f2}

\begin{DoxyCompactList}\small\item\em Placement single-\/object delete merely calls global placement delete. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classLoki_1_1SmallObjectBase_ad1c3a013df6cd2d95908003e006e1515}{}{\bfseries Small\+Object\+Base} (const \hyperlink{classLoki_1_1SmallObjectBase}{Small\+Object\+Base} \&)\label{classLoki_1_1SmallObjectBase_ad1c3a013df6cd2d95908003e006e1515}

\item 
\hypertarget{classLoki_1_1SmallObjectBase_a6e872e4f97b5572c294dc0162cbcccf6}{}\hyperlink{classLoki_1_1SmallObjectBase}{Small\+Object\+Base} \& {\bfseries operator=} (const \hyperlink{classLoki_1_1SmallObjectBase}{Small\+Object\+Base} \&)\label{classLoki_1_1SmallObjectBase_a6e872e4f97b5572c294dc0162cbcccf6}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$template$<$ class, class $>$ class Threading\+Model, std\+::size\+\_\+t chunk\+Size, std\+::size\+\_\+t max\+Small\+Object\+Size, std\+::size\+\_\+t object\+Align\+Size, template$<$ class $>$ class Lifetime\+Policy, class Mutex\+Policy$>$class Loki\+::\+Small\+Object\+Base$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$}

\hyperlink{structBase}{Base} class for small object allocation classes. The shared implementation of the new and delete operators are here instead of being duplicated in both \hyperlink{classLoki_1_1SmallObject}{Small\+Object} or \hyperlink{classLoki_1_1SmallValueObject}{Small\+Value\+Object}, later just called Small-\/\+Objects. This class is not meant to be used directly by clients, or derived from by clients. Class has no data members so compilers can use Empty-\/\+Base-\/\+Optimization.

\begin{DoxyParagraph}{Threading\+Model}
This class doesn\textquotesingle{}t support Object\+Level\+Lockable policy for Threading\+Model. The allocator is a singleton, so a per-\/instance mutex is not necessary. Nor is using Object\+Level\+Lockable recommended with \hyperlink{classLoki_1_1SingletonHolder}{Singleton\+Holder} since the Singleton\+Holder\+::\+Make\+Instance function requires a mutex that exists prior to when the object is created -\/ which is not possible if the mutex is inside the object, such as required for Object\+Level\+Lockable. If you attempt to use Object\+Level\+Lockable, the compiler will emit errors because it can\textquotesingle{}t use the default constructor in Object\+Level\+Lockable. If you need a thread-\/safe allocator, use the Class\+Level\+Lockable policy.
\end{DoxyParagraph}
\begin{DoxyParagraph}{Lifetime Policy}

\end{DoxyParagraph}
The \hyperlink{classLoki_1_1SmallObjectBase}{Small\+Object\+Base} template needs a lifetime policy because it owns a singleton of \hyperlink{classLoki_1_1SmallObjAllocator}{Small\+Obj\+Allocator} which does all the low level functions. When using a Small-\/\+Object in combination with the \hyperlink{classLoki_1_1SingletonHolder}{Singleton\+Holder} template you have to choose two lifetimes, that of the Small-\/\+Object and that of the singleton. The rule is\+: The Small-\/\+Object lifetime must be greater than the lifetime of the singleton hosting the Small-\/\+Object. Violating this rule results in a crash on exit, because the hosting singleton tries to delete the Small-\/\+Object which is then already destroyed.

The lifetime policies recommended for use with Small-\/\+Objects hosted by a \hyperlink{classLoki_1_1SingletonHolder}{Singleton\+Holder} template are
\begin{DoxyItemize}
\item \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectParent}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Parent} / \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectChild}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Child}
\item \hyperlink{classLoki_1_1SingletonWithLongevity}{Singleton\+With\+Longevity}
\item \hyperlink{classLoki_1_1FollowIntoDeath}{Follow\+Into\+Death} (not supported by M\+S\+V\+C 7.\+1)
\item \hyperlink{structLoki_1_1NoDestroy}{No\+Destroy}
\end{DoxyItemize}

The default lifetime of Small-\/\+Objects is \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectParent}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Parent} to insure that memory is not released before a object with the lifetime \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectChild}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Child} using that memory is destroyed. The \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectParent}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Parent} lifetime has the highest possible value of a Set\+Longevity lifetime, so you can use it in combination with your own lifetime not having also the highest possible value.

The \hyperlink{structLoki_1_1DefaultLifetime}{Default\+Lifetime} and \hyperlink{classLoki_1_1PhoenixSingleton}{Phoenix\+Singleton} policies are {\itshape not} recommended since they can cause the allocator to be destroyed and release memory for singletons hosting a object which inherit from either \hyperlink{classLoki_1_1SmallObject}{Small\+Object} or \hyperlink{classLoki_1_1SmallValueObject}{Small\+Value\+Object}.

\begin{DoxyParagraph}{Lifetime usage}

\end{DoxyParagraph}

\begin{DoxyItemize}
\item \hyperlink{namespaceLongevityLifetime}{Longevity\+Lifetime}\+: The Small-\/\+Object has \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectParent}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Parent} policy and the \hyperlink{classLoki_1_1Singleton}{Singleton} hosting the Small-\/\+Object has \hyperlink{structLoki_1_1LongevityLifetime_1_1DieAsSmallObjectChild}{Longevity\+Lifetime\+::\+Die\+As\+Small\+Object\+Child}. The child lifetime has a hard coded Set\+Longevity lifetime which is shorter than the lifetime of the parent, thus the child dies before the parent.
\item Both Small-\/\+Object and \hyperlink{classLoki_1_1Singleton}{Singleton} use \hyperlink{classLoki_1_1SingletonWithLongevity}{Singleton\+With\+Longevity} policy. The longevity level for the singleton must be lower than that for the Small-\/\+Object. This is why the \hyperlink{classLoki_1_1AllocatorSingleton}{Allocator\+Singleton}\textquotesingle{}s Get\+Longevity function returns the highest value.
\item \hyperlink{classLoki_1_1FollowIntoDeath}{Follow\+Into\+Death} lifetime\+: The Small-\/\+Object has Follow\+Into\+Death\+::\+With$<$\+L\+I\+F\+E\+T\+I\+M\+E$>$\+::\+As\+Master\+Liftime policy and the \hyperlink{classLoki_1_1Singleton}{Singleton} has Follow\+Into\+Death\+::\+After\+Master$<$\+M\+A\+S\+T\+E\+R\+S\+I\+N\+G\+L\+E\+T\+O\+N$>$\+::\+Is\+Destroyed policy, where you could choose the L\+I\+F\+E\+T\+I\+M\+E.
\item Both Small-\/\+Object and \hyperlink{classLoki_1_1Singleton}{Singleton} use \hyperlink{structLoki_1_1NoDestroy}{No\+Destroy} policy. Since neither is ever destroyed, the destruction order does not matter. Note\+: you will get memory leaks!
\item The Small-\/\+Object has \hyperlink{structLoki_1_1NoDestroy}{No\+Destroy} policy but the \hyperlink{classLoki_1_1Singleton}{Singleton} has \hyperlink{classLoki_1_1SingletonWithLongevity}{Singleton\+With\+Longevity} policy. Note\+: you will get memory leaks!
\end{DoxyItemize}

You should {\itshape not} use \hyperlink{structLoki_1_1NoDestroy}{No\+Destroy} for the singleton, and then use \hyperlink{classLoki_1_1SingletonWithLongevity}{Singleton\+With\+Longevity} for the Small-\/\+Object.

\begin{DoxyParagraph}{Examples\+:}

\end{DoxyParagraph}

\begin{DoxyItemize}
\item test/\+Small\+Obj/\+Small\+Singleton.\+cpp
\item test/\+Singleton/\+Dependencies.\+cpp 
\end{DoxyItemize}

\subsection{Member Typedef Documentation}
\hypertarget{classLoki_1_1SmallObjectBase_ad07df1c9ec9c41580e07e32eddcda82d}{}\index{Loki\+::\+Small\+Object\+Base@{Loki\+::\+Small\+Object\+Base}!Obj\+Allocator\+Singleton@{Obj\+Allocator\+Singleton}}
\index{Obj\+Allocator\+Singleton@{Obj\+Allocator\+Singleton}!Loki\+::\+Small\+Object\+Base@{Loki\+::\+Small\+Object\+Base}}
\subsubsection[{Obj\+Allocator\+Singleton}]{\setlength{\rightskip}{0pt plus 5cm}template$<$template$<$ class, class $>$ class Threading\+Model, std\+::size\+\_\+t chunk\+Size, std\+::size\+\_\+t max\+Small\+Object\+Size, std\+::size\+\_\+t object\+Align\+Size, template$<$ class $>$ class Lifetime\+Policy, class Mutex\+Policy$>$ typedef {\bf Allocator\+Singleton}$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy $>$ {\bf Loki\+::\+Small\+Object\+Base}$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$\+::{\bf Obj\+Allocator\+Singleton}}\label{classLoki_1_1SmallObjectBase_ad07df1c9ec9c41580e07e32eddcda82d}
Defines type of allocator singleton, must be public to handle singleton lifetime dependencies. 

\subsection{Member Function Documentation}
\hypertarget{classLoki_1_1SmallObjectBase_ab835d84fa8bc1ed3a558dc2e7a7e39ec}{}\index{Loki\+::\+Small\+Object\+Base@{Loki\+::\+Small\+Object\+Base}!operator delete@{operator delete}}
\index{operator delete@{operator delete}!Loki\+::\+Small\+Object\+Base@{Loki\+::\+Small\+Object\+Base}}
\subsubsection[{operator delete(void $\ast$p, const std\+::nothrow\+\_\+t \&)}]{\setlength{\rightskip}{0pt plus 5cm}template$<$template$<$ class, class $>$ class Threading\+Model, std\+::size\+\_\+t chunk\+Size, std\+::size\+\_\+t max\+Small\+Object\+Size, std\+::size\+\_\+t object\+Align\+Size, template$<$ class $>$ class Lifetime\+Policy, class Mutex\+Policy$>$ static void {\bf Loki\+::\+Small\+Object\+Base}$<$ Threading\+Model, chunk\+Size, max\+Small\+Object\+Size, object\+Align\+Size, Lifetime\+Policy, Mutex\+Policy $>$\+::operator delete (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{p, }
\item[{const std\+::nothrow\+\_\+t \&}]{}
\end{DoxyParamCaption}
) throw  ) \hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}\label{classLoki_1_1SmallObjectBase_ab835d84fa8bc1ed3a558dc2e7a7e39ec}
Non-\/throwing single-\/object delete is only called when nothrow new operator is used, and the constructor throws an exception. 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+Users/pourya/\+Desktop/platform/repos/tetcutter/src/3rdparty/loki/include/loki/Small\+Obj.\+h\end{DoxyCompactItemize}
